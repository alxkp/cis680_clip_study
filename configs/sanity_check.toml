mode = "train"
experiment = "sanity_check"
seed = 42
print_every_n = 1

[model]
type = "clip32"
name = "openai/clip-vit-base-patch32"

[dataset]
type = "winoground"
batch_size = 8
num_loaders = 0

[train]
lr = 1e-4
n_epochs = 2
optimizer = "adamw"
weight_decay = 0.01
scheduler = "constant"
warmup_epochs = 0
grad_clip_norm = 1.0
val_every_n_epochs = 1

[train.loss]
type = "cka"
center = true

[checkpoint]
save_every_n_epochs = 100
save_best = false
max_checkpoints = 1

[eval]
include_winoground = true
include_coco = false
include_flickr = false
include_imagenet = false
batch_size = 8
max_samples = 16
